generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model IgUser {
  id                String       @id @default(cuid())
  igUserId          BigInt       @unique
  username          String?
  name              String?
  profilePictureUrl String?
  accountType       String?
  accessToken       String
  tokenExpireDay    DateTime
  tokenCreatedAt    DateTime
  tokenExpireIn     Int
  permissions       String[]
  createdAt         DateTime     @default(now())
  updatedAt         DateTime     @updatedAt
  rules             Automation[]
}

model Automation {
  id               String           @id @default(cuid())
  igUserId         BigInt
  name             String
  mediaId          String
  rule             Json
 campaignType     String
  status           AutomationStatus @default(DRAFT)
  isActive         Boolean          @default(false)
  lastExecutedAt   DateTime?
  executionCount   Int              @default(0)
  errorCount       Int              @default(0)
  lastErrorAt      DateTime?
  lastErrorMessage String?
  createdAt        DateTime         @default(now())
  updatedAt        DateTime         @updatedAt
  account          IgUser           @relation(fields: [igUserId], references: [igUserId])
}

enum AutomationStatus {
  DRAFT
  ACTIVE
  PAUSED
  ARCHIVED
}
